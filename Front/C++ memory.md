# C++ 内存布局 (Memory Layout)

```
高地址 ↑
┌────────────────────────────────────────────┐
│                  栈区 (Stack)              │  ← 局部变量、函数参数
│  📦 自动管理：函数结束自动释放              │     地址从高往低长
│  例：int x = 10;                           │
├────────────────────────────────────────────┤
│                    ↓ 向下生长               │
│                    ⬇️                      │
│                                            │
│                    ⬆️                      │
│                    ↑ 向上生长               │
├────────────────────────────────────────────┤
│                  堆区 (Heap)                │  ← new/malloc 分配
│  🏔️ 手动管理：需要 delete/free 释放         │     地址从低往高长
│  例：int* p = new int(10);                  │
├────────────────────────────────────────────┤
│              全局/静态区 (Data)             │  ← 全局变量、static 变量
│  🔶 程序启动分配，结束释放                  │
│  例：int globalVar = 100;                  │
├────────────────────────────────────────────┤
│                常量区 (Rodata)              │  ← 字符串常量等
│  例："Hello World"                         │
├────────────────────────────────────────────┤
│                代码区 (Code)                │  ← 存放程序代码
│  🔷 函数的机器码                            │     只读！
└────────────────────────────────────────────┘
低地址 ↓
```

---

## 📊 各区域对比表

| 区域 | 存储内容 | 生命周期 | 管理 | 方向 |
|:---:|:---|:---|:---:|:---:|
| **栈区 (Stack)** | 局部变量、函数参数 | 函数调用期间 | 自动 | ↓ |
| **堆区 (Heap)** | `new`/`malloc` 分配 | 手动控制 | 手动 | ↑ |
| **全局/静态区 (Data)** | 全局/`static` 变量 | 程序运行期间 | 自动 | - |
| **常量区 (Rodata)** | 字符串常量 | 程序运行期间 | 只读 | - |
| **代码区 (Code)** | 机器指令 | 程序运行期间 | 只读 | - |

---

## 🔑 关键要点

1. **栈 vs 堆**：栈快但空间小，堆慢但空间大
2. **内存泄漏**：堆区 `new` 了不 `delete` 就会泄漏
3. **栈溢出**：递归太深或局部数组太大会导致栈溢出
